<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="Content-Security-Policy" content="child-src 'https://facebook.com';">
    <title>Facebook Login</title>
    <!-- http://hayageek.com/facebook-javascript-sdk/ -->
    <!-- 
    <script type="text/javascript" src="cordova.js"></script>    
	<script type="text/javascript" src="facebook-js-sdk.js"></script>
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
	<script src="https://connect.facebook.net/en_US/all.js"></script>	
	-->
	<link href="https://s3.amazonaws.com/hayageek/libs/jquery/bootstrap.min.css" rel="stylesheet">
	
	<script type="text/javascript" src="cordova.js"></script>
	<script type="text/javascript" src="https://connect.facebook.net/en_US/all/debug.js"></script>	
    <script type="text/javascript" src="cdv-plugin-fb-connect.js"></script><!-- cordova facebook plugin -->
	    
	
</head>
<body>   
    
    <div id="fb-root"></div>
    
    <script>
    	function init() {
	    	//window.fbAsyncInit = function() {
		     FB.init({
		        appId: '1631549553795045',
	            //nativeInterface: CDV.FB,
	            channelUrl : 'http://www.example.com/fb_social/channel',
	            status     : false, // check login status
		        cookie     : true, // enable cookies to allow the server to access the session
		        xfbml      : true  // parse XFBML
	        });
		    console.log('Facebook init!');  
		    
			FB.Event.subscribe('auth.authResponseChange', function(response) 
			{
		 	 if (response.status === 'connected') 
		  	{
		  		document.getElementById("message").innerHTML +=  "<br>Connected to Facebook";
		  		//SUCCESS
		  		
		  	}	 
			else if (response.status === 'not_authorized') 
		    {
		    	document.getElementById("message").innerHTML +=  "<br>Failed to Connect";
		
				//FAILED
		    } else 
		    {
		    	document.getElementById("message").innerHTML +=  "<br>Logged Out";
		    	//UNKNOWN ERROR
		    }
			});	
			
		    //};
	    }
	    
	    function Login() {
 			init();
	        FB.login(function(response) {
	           if (response.authResponse) 
	           {
	                getUserInfo();
	            } else 
	            {
	             console.log('User cancelled login or did not fully authorize.');
	            }
	         },{scope: 'email,user_photos,user_videos'});
	 
	    }
 
	   function getUserInfo() {
	        FB.api('/me', function(response) {
	 
	        var str="<b>Name</b> : "+response.name+"<br>";
	          str +="<b>Link: </b>"+response.link+"<br>";
	          str +="<b>Username:</b> "+response.username+"<br>";
	          str +="<b>id: </b>"+response.id+"<br>";
	          str +="<b>Email:</b> "+response.email+"<br>";
	          str +="<input type='button' value='Get Photo' onclick='getPhoto();'/>";
	          str +="<input type='button' value='Logout' onclick='Logout();'/>";
	          document.getElementById("status").innerHTML=str;
	 
	    	});
	    }
	    
	    function getPhoto() {
	      FB.api('/me/picture?type=normal', function(response) {
	 
	          var str="<br/><b>Pic</b> : <img src='"+response.data.url+"'/>";
	          document.getElementById("status").innerHTML+=str;
	 
	    	});	 
	    }
	    
	    function Logout()  {
	        FB.logout(function(){document.location.reload();});
	    }
 
	  // Load the SDK asynchronously
	  //(function(d){
	  //   var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
	  //   if (d.getElementById(id)) {return;}
	  //   js = d.createElement('script'); js.id = id; js.async = true;
	  //   js.src = "https://connect.facebook.net/en_US/all.js";
	  //   ref.parentNode.insertBefore(js, ref);
	  // }(document));
	  
    </script>
	
	<div id="status">
		<button class="btn btn-primary btn-large" onclick="Login()" style="text-align:center; top:20px;">Login with Facebook</button>
	</div>

	<br/>

	<div id="message">
	</div>
	

</body>
</html>